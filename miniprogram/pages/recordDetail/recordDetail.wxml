<!--pages/recordDetail/recordDetail.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="header">
    <view class="back-btn" bindtap="goBack">
      <text class="back-arrow">â†</text>
    </view>
    <text class="title">è®°å½•è¯¦æƒ…</text>
    <view class="header-actions">
      <view class="action-btn collect-btn {{isCollected ? 'collected' : ''}}" bindtap="toggleCollect">
        <text class="action-icon">{{isCollected ? 'â˜…' : 'â˜†'}}</text>
      </view>
      <view class="action-btn share-btn" bindtap="shareRecord">
        <text class="action-icon">ğŸ“¤</text>
      </view>
      <view class="action-btn delete-btn" bindtap="deleteRecord">
        <text class="action-icon">ğŸ—‘ï¸</text>
      </view>
    </view>
  </view>

  <!-- è®°å½•å†…å®¹ -->
  <view class="record-content" wx:if="{{record}}">
    <!-- æ˜¾ç¤ºæ‰€æœ‰ç›¸å…³è®°å½• -->
    <view class="records-list">
      <view class="record-item" wx:for="{{relatedRecords}}" wx:key="id">
        <view class="record-header">
          <text class="record-label" wx:if="{{item.isAppend}}">è¿½åŠ è®°å½•</text>
          <text class="record-label" wx:else>åŸå§‹è®°å½•</text>
          <text class="record-time">{{item.createTime}}</text>
        </view>
        <view class="record-text">
          <text class="record-text-content" bindtap="onContentTap" data-content="{{item.content}}" data-record="{{item}}">{{item.displayContent}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section" wx:if="{{record}}">
    <button class="action-button append-button" bindtap="appendRecord">è¿½åŠ è®°å½•</button>
  </view>

  <!-- è¿½åŠ è®°å½•å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showAppendModal}}" bindtap="closeAppendModal">
    <view class="append-modal" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">è¿½åŠ è®°å½•</text>
        <view class="close-btn" bindtap="closeAppendModal">
          <text class="close-icon">Ã—</text>
        </view>
      </view>
      <view class="modal-content">
        <textarea 
          value="{{appendContent}}"
          bindinput="onAppendInput"
          placeholder="è¾“å…¥è¦è¿½åŠ çš„å†…å®¹..."
          maxlength="800"
          class="append-textarea">
        </textarea>
        <view class="char-count">{{appendContent.length}}/800</view>
      </view>
      <view class="modal-actions">
        <button class="modal-btn cancel-btn" bindtap="closeAppendModal">å–æ¶ˆ</button>
        <button class="modal-btn save-btn" bindtap="saveAppendContent">ä¿å­˜</button>
      </view>
    </view>
  </view>
</view> 