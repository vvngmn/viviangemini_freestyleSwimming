Page({
  data: {
    tipDetail: null
  },

  onLoad(options) {
    const tipId = parseInt(options.id);
    this.loadTipDetail(tipId);
    this.loadCollectStatus(tipId);
  },

  onShow() {
    // 页面显示时重新加载收藏状态
    if (this.data.tipDetail) {
      this.loadCollectStatus(this.data.tipDetail.id);
    }
  },

  // 加载技巧详情
  loadTipDetail(tipId) {
    const tipDetails = [
      {
        id: 1,
        title: '保持头部中立位置',
        content: `在自由泳中，保持头部与身体其他部位在一条直线上，并直接看向池底。

当你游泳时，许多人倾向于向前看而不是向下看。这种方法的问题在于它会导致腿部和臀部下沉。

结果是你必须更用力地踢腿来保持腿部向上，这会导致你更快地疲劳和喘不过气来。

此外，长时间保持这种向前看的姿势会对颈部造成压力。

正确的做法：
- 保持头部与脊柱在一条直线上
- 眼睛看向池底，距离前方1-2米
- 避免抬头或低头，保持自然视线

练习方法：
1. 在浅水区练习，将脸浸入水中
2. 保持头部位置不变，只转动身体呼吸
3. 感受头部"漂浮"在水面上的感觉`
      },
      {
        id: 2,
        title: '学会按压浮力',
        content: `在自由泳中保持良好平衡的关键是学会如何"按压浮力"。

"按压浮力"意味着在水中，你始终稍微向下推胸部。

想象你的身体是一个跷跷板。支点在肚脐和腹股沟之间。

你的上半身代表跷跷板的一端，充满空气的肺部充当浮标。你的腿代表跷跷板的另一端。

如果你稍微向下推胸部，你的身体会在支点处转动，臀部和腿部会向上移动。

学习这种游泳技巧通常是一个重大突破，因为它让你无需费力就能保持腿部向上。这让你可以专注于其他方面的划水。

练习要点：
- 感受胸部向下压的感觉
- 保持身体水平
- 让腿部自然浮起
- 减少踢腿的力度

这种技巧对于长距离游泳特别重要，可以大大节省体力。`
      },
      {
        id: 3,
        title: '呼吸时不要抬头',
        content: `在转向侧面呼吸之前，不要向前抬头。这个常见错误会导致臀部和腿部下沉。

相反，向侧面滚动，同时稍微转动头部，使嘴巴离开水面。

这应该感觉像是你的头部靠在水的表面上，然后你转向侧面呼吸。

理想情况下，当你呼吸时，你应该有一只眼睛在水面上方，一只眼睛在水面下方。然而，能够做到这一点需要时间和练习。

正确的呼吸技巧：
1. 保持头部低，通过转动而不是抬起
2. 身体和头部同时转动
3. 呼吸要快而小
4. 保持身体平衡

常见错误：
- 抬头呼吸（会导致腿部下沉）
- 头部转动过大
- 呼吸时间过长

练习方法：
- 在浅水区练习侧身呼吸
- 使用呼吸管练习身体转动
- 逐渐减少呼吸时间`
      },
      {
        id: 4,
        title: '在侧面游泳',
        content: `在划水周期中，让你的身体从一侧滚动到另一侧。

如果你以这种方式从一侧滚动到另一侧，而不是"平躺"游泳，你可以激活更大的背部肌肉，除了肩部肌肉外，这为你的手臂划水提供了额外的力量。

这种滚动技术的好处：
- 增加推进力
- 减少阻力
- 更好地利用核心肌肉
- 改善身体平衡

正确的滚动技巧：
1. 每次划水时身体转动30-45度
2. 从臀部开始转动，肩膀跟随
3. 保持头部稳定
4. 感受水流过身体的感觉

练习方法：
- 使用单臂划水练习
- 侧身漂浮练习
- 逐渐增加转动幅度

注意事项：
- 不要过度转动
- 保持身体流线型
- 呼吸时保持转动`
      },
      {
        id: 5,
        title: '在水中呼气',
        content: `要发展有效的自由泳划水，你需要在脸在水中时持续呼气，这样当你转向侧面吸气时，肺部几乎空了。

这样做的原因是嘴巴在水面上的时间太短，无法同时吸气和呼气。

通过持续呼气，你也比屏住呼吸时更放松。

正确的呼吸节奏：
- 脸在水中时持续呼气
- 转向侧面时快速吸气
- 保持呼吸节奏稳定

练习方法：
1. 在浅水区练习呼气
2. 发出"嗡嗡"声或叹息声
3. 感受气泡从鼻子和嘴巴流出
4. 逐渐增加呼气时间

呼吸模式建议：
- 初学者：每2-3次划水呼吸一次
- 进阶者：每3-5次划水呼吸一次
- 长距离：每4-6次划水呼吸一次

常见错误：
- 屏住呼吸
- 呼气不充分
- 呼吸时间过长`
      },
      {
        id: 6,
        title: '使用高肘位置',
        content: `在手臂划水开始时使用高肘位置。

高肘位置包括在手臂划水开始时保持肘部在水中较高，弯曲它，并向外移动，使前臂进入垂直位置。

前臂和手掌然后面向后方，游泳者可以以最大效率向后推水。

高肘技术的好处：
- 增加推进力
- 减少肩部压力
- 更好地利用背部肌肉
- 提高划水效率

正确的技术要点：
1. 肘部保持在肩部水平
2. 前臂垂直向下
3. 手掌面向后方
4. 保持肘部弯曲90-120度

练习方法：
- 使用划水板练习
- 慢动作练习
- 感受水的阻力

常见错误：
- 肘部下垂
- 手臂过度伸直
- 手掌方向错误

进阶技巧：
- 早期垂直前臂（EVF）
- 手掌抓水技术
- 推进力最大化`
      },
      {
        id: 7,
        title: '恢复手臂时不要伸得太远',
        content: `当你在水面上恢复手臂时，不要完全向前伸展，然后立即掉入水中。

这样做有两个不好的原因：
1. 首先，它在水中产生湍流和额外的阻力
2. 其次，它可能导致肩部撞击和肌腱炎，这种情况被称为游泳者肩

因此，你应该更早地将手滑入水中，例如在完全伸展手臂距离的一半处。然后在水下进一步伸展手臂。

正确的恢复技术：
- 手臂放松，自然摆动
- 手在头部附近入水
- 避免过度伸展
- 保持流线型

练习方法：
- 慢动作恢复练习
- 使用镜子观察动作
- 感受手臂的自然摆动

预防肩部问题：
- 避免过度伸展
- 保持肩部放松
- 定期进行肩部拉伸
- 注意技术细节

进阶技巧：
- 手臂入水角度
- 恢复节奏
- 身体协调`
      },
      {
        id: 8,
        title: '长距离游泳使用两拍踢腿',
        content: `使用放松的两拍踢腿对于长距离游泳是理想的，因为它节省能量。

对于学习自由泳划水，使用两拍踢腿也是有意义的，因为你需要更少的氧气，呼吸更容易，因此你可以比使用六拍踢腿时更放松。

另一方面，六拍踢腿更适合短距离冲刺比赛，因为它提供更多推进力，让你游得更快。缺点是你的大腿肌肉使用大量氧气，你会更快地喘不过气来。

踢腿技术对比：
两拍踢腿：
- 每次划水周期踢一次腿
- 适合长距离游泳
- 节省体力
- 呼吸更容易

六拍踢腿：
- 每次划水周期踢三次腿
- 适合短距离冲刺
- 提供更多推进力
- 消耗更多体力

练习方法：
- 使用踢腿板练习
- 逐渐增加距离
- 感受不同节奏

选择建议：
- 初学者：从两拍踢腿开始
- 长距离：坚持两拍踢腿
- 短距离：考虑六拍踢腿`
      },
      {
        id: 9,
        title: '不要向前推水',
        content: `在恢复期间向前伸展手臂时，确保保持手掌平坦并与水面平行，手掌朝下。

自由泳游泳者的一个常见错误是在手臂恢复结束时在水中向上弯曲手。当他们这样做时，他们向前推水，从而减慢自己的速度。

这个错误有时被称为"踩刹车"。

正确的手部位置：
- 手掌与水面平行
- 手指自然伸展
- 避免向上弯曲手腕
- 保持流线型

练习方法：
- 慢动作练习手部位置
- 使用镜子观察
- 感受水的阻力

常见错误：
- 手掌向上
- 手指过度弯曲
- 手腕角度错误

技术要点：
- 手部入水角度
- 手指间距
- 手掌方向
- 恢复路径

进阶技巧：
- 手部抓水技术
- 推进力最大化
- 阻力最小化`
      },
      {
        id: 10,
        title: '使用鼻夹是可以的',
        content: `在学习自由泳时，使用鼻夹可以帮助防止水进入鼻子。

如果你不必担心水进入鼻子，你可以在做游泳练习时更放松。这反过来又加速了你的进步。

几个月后，一旦你掌握了自由泳的基础知识，你就可以逐渐摆脱鼻夹。

鼻夹的好处：
- 防止水进入鼻子
- 减少焦虑
- 更容易专注于技术
- 加快学习进度

使用建议：
- 初学者可以放心使用
- 逐渐减少使用时间
- 最终完全摆脱

替代方案：
- 学习正确的呼气技巧
- 使用呼吸管
- 练习水下呼气

注意事项：
- 选择合适大小的鼻夹
- 确保舒适度
- 不要过度依赖

进阶技巧：
- 逐渐减少使用频率
- 在浅水区练习不用鼻夹
- 培养正确的呼吸习惯`
      }
    ];

    const currentTip = tipDetails.find(tip => tip.id === tipId);
    if (currentTip) {
      // 检查收藏状态
      const collectedItems = wx.getStorageSync('collectedItems') || [];
      const isCollected = collectedItems.some(item => item.id === tipId && item.type === 'tip');
      
      this.setData({
        tipDetail: {
          ...currentTip,
          isCollected: isCollected
        }
      });
    }
  },

  // 切换收藏状态
  toggleCollect() {
    const tipDetail = this.data.tipDetail;
    if (!tipDetail) return;

    const collectedItems = wx.getStorageSync('collectedItems') || [];
    const itemIndex = collectedItems.findIndex(item => item.id === tipDetail.id && item.type === 'tip');
    
    if (itemIndex > -1) {
      // 取消收藏
      collectedItems.splice(itemIndex, 1);
      wx.showToast({
        title: '已取消收藏',
        icon: 'none',
        duration: 1500
      });
    } else {
      // 添加收藏
      collectedItems.push({
        id: tipDetail.id,
        type: 'tip',
        title: tipDetail.title,
        summary: tipDetail.content.substring(0, 100) + '...',
        icon: '📝',
        collectTime: new Date().toISOString()
      });
      wx.showToast({
        title: '已添加到收藏',
        icon: 'success',
        duration: 1500
      });
    }
    
    wx.setStorageSync('collectedItems', collectedItems);
    
    // 更新页面状态
    this.setData({
      'tipDetail.isCollected': itemIndex === -1
    });
  },

  // 返回上一页
  goBack() {
    wx.navigateBack();
  },

  // 分享功能
  shareTip() {
    wx.showShareMenu({
      withShareTicket: true,
      menus: ['shareAppMessage', 'shareTimeline']
    });
  },

  // 分享功能
  onShareAppMessage() {
    const tipDetail = this.data.tipDetail;
    return {
      title: tipDetail ? tipDetail.title : '自由泳技巧分享',
      path: '/pages/tipDetail/tipDetail?id=' + (tipDetail ? tipDetail.id : 1)
    };
  }
}); 